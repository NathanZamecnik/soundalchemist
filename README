THIS CODE IS A TERRIBLE MESS. just sayin