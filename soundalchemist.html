<head>
  <title>soundalchemist</title>
  <script type="text/javascript" src="/soundcloud.player.api.js">
  </script>
</head>

<body>
  {{> main}}
</body>

<template name="main">
  {{#if isLobby}}
  {{> lobby}}
  {{else}}
  {{> room}}
  {{/if}}
</template>

<!-- xcxc get rid of a href="#" -->

<template name="lobby">
  <p>
  Welcome to soundalchemist v0.001 or something! Anyone want to help me design this? avital@thewe.net; oh also https://github.com/avital/soundalchemist
  </p>

  <p>
    So,! This is a musical journey. Create a new room and put some amazing soundcloud track (dj sets work great) with which to start. You'll see three recommendations. You can +1 or -1 (wait for these links to appear!) each of them to change the subsequent recommendations. NOTE! +1/-1 don't exactly mean "like/dislike"; rather they mean something like "I'd like the music to shift more towards things like this" or the opposite. It's like reaching a fork and turning left or right; or neither to continue on a similar path.
  </p>

  <p>
    There are lots of bugs and stuff, like the music stops whenever you +1 etc... or that until all the +1/-1 buttons appear no +1/-1 action takes effect... all of those will be fixed but I've already found amazing music this way so I suspect others can as well.
  </p>
  

  <a href="#" id="newroom">new room</a>
</template>

<template name="room">
  {{> sources}}
  <hr />
  {{> recommendations}}
</template>

<template name="processing">
  {{#if processing}}<p>processing...</p>{{/if}}
</template>

<template name="sources">
  {{> processing}}
  {{#each list}}
  {{> source-track}}
  {{/each}}

  <input id="url"
         placeholder="e.g. http://soundcloud.com/russliquid/russ-liquid-soundcloud-mix"
         />
  <input id="add" type="button" value="add" />
</template>

<template name="recommendations">
  {{#each list}}
  {{> recommendation-track}}
  {{/each}}
</template>

<template name="source-track">
  <p id="source-track-{{trackId}}">
    {{weight}} <a class="change_weight" href="#">change</a>
    <a href="#" class="unmake-source">unstore as a source</a>
    <a href="{{url}}" target="_blank">{{url}}</a>
    {{trackId}}
  </p>
</template>

<template name="recommendation-track">
  <p>
    {{rank}}
    {{spectrum}}
    {{> voting}}
    <a href="#" class="skip">skip</a>
    {{> outer_track}}
  </p>
</template>

<template name="voting">
  {{#if loaded}}
  <a href="#" class="upvote">+1</a>
  <a href="#" class="downvote">-1</a>
  {{/if}}
</template>

<template name="outer_track">
  {{> track}}
</template>

<template name="track">
  <iframe id="{{playerId}}" frameborder="no" height="166" scrolling="no"
          src="http://w.soundcloud.com/player/?url={{escapedUrl}}&auto_play=false&show_artwork=true&color=d31502"
          width="100%">
  </iframe>
</template>

